import{r as n,j as e,l as H,m as U,n as V,o as W,p as K,q as Q,s as X}from"./vendor-ui-Cj-e85pn.js";import{c as M,j as N,B as o,M as G,f as z,p as b,u as J,C as k,a as Y,b as Z,d as ee,e as w,x as se,t as C}from"./index-Dfmm_0fk.js";import{I as v}from"./input-C8BfD-fZ.js";import{L as r}from"./label-E-yG1832.js";import{S as g}from"./switch-KUvqxH1h.js";import{D as ae,a as le,b as te,c as re}from"./dialog-a2Tqj8Rw.js";import{M as ie}from"./MapComponent-g7d2Sjwu.js";import{A as ne,a as ce}from"./avatar-BO_T0zJC.js";import{S as _}from"./sparkles-BHCbG1nG.js";import{S as de}from"./smartphone-DeilRpYv.js";import{L as S}from"./locate-CzaG9Ru8.js";import{C as B}from"./calendar-clock-iBTx0G7v.js";import{T as oe}from"./timer-CvvNVd72.js";import{U as O}from"./users-round-UfwlVbch.js";import{C as me}from"./circle-dollar-sign-BAeLdFg6.js";import{a as xe}from"./useTrips-CTROK9dC.js";import{d as he}from"./mockDataService-CdsvJtHv.js";import{M as pe}from"./move-right-BXP28HUH.js";import"./vendor-react-7PqXWhc5.js";import"./vendor-utils-MHJ_mICC.js";import"./vendor-supabase-BfzcFBqZ.js";import"./vendor-animation-BozBRtxF.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],ge=M("sliders-horizontal",je);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}]],ue=M("sparkle",fe);function F({className:a,defaultValue:m,value:x,min:h=0,max:t=100,...j}){const f=n.useMemo(()=>Array.isArray(x)?x:Array.isArray(m)?m:[h,t],[x,m,h,t]);return e.jsxs(H,{"data-slot":"slider",defaultValue:m,value:x,min:h,max:t,className:N("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",a),...j,children:[e.jsx(U,{"data-slot":"slider-track",className:N("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-4 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:e.jsx(V,{"data-slot":"slider-range",className:N("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:f.length},(c,i)=>e.jsx(W,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},i))]})}function ve({...a}){return e.jsx(K,{"data-slot":"collapsible",...a})}function ye({...a}){return e.jsx(Q,{"data-slot":"collapsible-trigger",...a})}function Ne({...a}){return e.jsx(X,{"data-slot":"collapsible-content",...a})}function be({trip:a,open:m,onClose:x,onBook:h}){const[t,j]=n.useState(1);if(!a)return null;const f=[{lat:a.stops?.[0]?.lat||25.2048,lng:a.stops?.[0]?.lng||55.2708,label:a.from,type:"start"},...a.stops?.slice(1,-1).map((c,i)=>({lat:c.lat,lng:c.lng,label:c.label,type:"stop"}))||[],{lat:a.stops?.[a.stops.length-1]?.lat||24.4539,lng:a.stops?.[a.stops.length-1]?.lng||54.3773,label:a.to,type:"destination"}];return e.jsx(ae,{open:m,onOpenChange:x,children:e.jsxs(le,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(te,{children:e.jsx(re,{children:"Trip Details"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(ne,{className:"w-16 h-16",children:e.jsx(ce,{className:"bg-primary text-primary-foreground text-xl",children:a.driver.initials})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{children:a.driver.name}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground mt-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:a.driver.rating})]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[a.driver.trips," trips completed"]})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsxs(o,{size:"sm",variant:"outline",className:"gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),"Call"]}),e.jsxs(o,{size:"sm",variant:"outline",className:"gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),"Message"]})]})]}),e.jsx(z,{variant:a.tripType==="wasel"?"default":"secondary",children:a.tripType==="wasel"?"Wasel (ÙˆØ§ØµÙ„)":"Raje3 (Ø±Ø§Ø¬Ø¹)"})]}),e.jsx(b,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{children:"Route & Stops"}),e.jsx(ie,{locations:f,showRoute:!0,height:"350px"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{children:"Trip Information"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(S,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Route"}),e.jsxs("p",{children:[a.from," â†’ ",a.to]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(B,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Date"}),e.jsx("p",{children:a.date})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(oe,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Departure Time"}),e.jsx("p",{children:a.time})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{children:"Booking Details"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(O,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Available Seats"}),e.jsxs("p",{children:[a.seats," seats left"]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(me,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Price per Seat"}),e.jsxs("p",{className:"text-2xl text-primary",children:["$",a.price]})]})]}),a.vehicleModel&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-5 h-5 flex items-center justify-center mt-0.5",children:"ðŸš—"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Vehicle"}),e.jsx("p",{children:a.vehicleModel})]})]})]})]}),a.stops&&a.stops.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(b,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{children:"Stops Along the Way"}),e.jsx("div",{className:"space-y-2",children:a.stops.map((c,i)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:`
                        w-6 h-6 rounded-full flex items-center justify-center text-xs
                        ${i===0?"bg-primary text-primary-foreground":i===a.stops.length-1?"bg-accent text-accent-foreground":"bg-secondary text-secondary-foreground"}
                      `,children:i===0?"A":i===a.stops.length-1?"B":i}),e.jsx("p",{children:c.label})]},i))})]})]}),a.notes&&e.jsxs(e.Fragment,{children:[e.jsx(b,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{children:"Additional Notes"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.notes})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Number of Seats"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(o,{size:"sm",variant:"outline",onClick:()=>j(Math.max(1,t-1)),disabled:t<=1,children:"-"}),e.jsx("span",{className:"w-8 text-center",children:t}),e.jsx(o,{size:"sm",variant:"outline",onClick:()=>j(Math.min(a.seats,t+1)),disabled:t>=a.seats,children:"+"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Price"}),e.jsxs("p",{className:"text-2xl text-primary",children:["$",a.price*t]})]})]}),e.jsxs(o,{size:"lg",className:"bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>{h&&h(a.id),x()},children:["Book ",t," Seat",t>1?"s":""]})]})]})]})})}function Ke(){const{user:a}=J(),[m,x]=n.useState(""),[h,t]=n.useState(""),[j,f]=n.useState(""),[c,i]=n.useState("1"),[L,q]=n.useState(null),[$,y]=n.useState(!1),[R,T]=n.useState(!1),[ke,we]=n.useState("match"),{trips:D,loading:u,searchTrips:A}=xe({from:m,to:h,departureDate:j,seats:parseInt(c)}),[d,p]=n.useState({priceRange:[0,200],minRating:4,verifiedOnly:!1,instantBook:!1,preferences:{noSmoking:!1,petsAllowed:!1,musicOk:!1,quietRide:!1}}),I=()=>{A()},P=s=>{const l={id:parseInt(s.id.replace("trip-",""))||1,driver:{name:"Driver Name",initials:"DN",rating:4.5,trips:25},from:s.from,to:s.to,date:s.departure_date,time:s.departure_time,seats:s.available_seats,price:s.price_per_seat,tripType:"wasel"};q(l),y(!0)},E=async s=>{if(!a){C.error("Please sign in to book a trip");return}try{await he.createBooking(s.toString(),parseInt(c)),C.success('Trip booked successfully! Check "My Trips" for details.'),y(!1),A()}catch(l){C.error(l.message||"Failed to book trip")}};return e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsxs(k,{children:[e.jsxs(Y,{children:[e.jsx(Z,{children:"Find a Ride"}),e.jsx(ee,{children:"Search for available rides across the Middle East"})]}),e.jsxs(w,{children:[e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"From"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground"}),e.jsx(v,{placeholder:"Starting location",value:m,onChange:s=>x(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"To"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground"}),e.jsx(v,{placeholder:"Destination",value:h,onChange:s=>t(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground"}),e.jsx(v,{type:"date",value:j,onChange:s=>f(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Passengers"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground"}),e.jsx(v,{type:"number",min:"1",max:"8",value:c,onChange:s=>i(s.target.value),className:"pl-10"})]})]})]}),e.jsx(o,{className:"w-full md:w-auto mt-4 bg-primary hover:bg-primary/90 text-primary-foreground",onClick:I,disabled:u,children:u?"Searching...":"Search Rides"})]})]}),e.jsx(k,{children:e.jsx(w,{className:"pt-6",children:e.jsxs(ve,{open:R,onOpenChange:T,children:[e.jsx(ye,{asChild:!0,children:e.jsxs(o,{variant:"outline",className:"w-full justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),"Advanced Filters"]}),R?e.jsx(se,{className:"w-4 h-4"}):e.jsx(ue,{className:"w-4 h-4"})]})}),e.jsxs(Ne,{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{children:["Max Price: $",d.priceRange[1]]}),e.jsx(F,{value:d.priceRange,onValueChange:s=>p(l=>({...l,priceRange:s})),max:500,min:0,step:10,className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{children:["Minimum Rating: ",d.minRating," stars"]}),e.jsx(F,{value:[d.minRating],onValueChange:s=>p(l=>({...l,minRating:s[0]})),max:5,min:0,step:.5,className:"w-full"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(r,{children:"Preferences"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{id:"no-smoking",checked:d.preferences.noSmoking,onCheckedChange:s=>p(l=>({...l,preferences:{...l.preferences,noSmoking:s}}))}),e.jsx(r,{htmlFor:"no-smoking",children:"No Smoking"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{id:"pets-allowed",checked:d.preferences.petsAllowed,onCheckedChange:s=>p(l=>({...l,preferences:{...l.preferences,petsAllowed:s}}))}),e.jsx(r,{htmlFor:"pets-allowed",children:"Pets Allowed"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{id:"music-ok",checked:d.preferences.musicOk,onCheckedChange:s=>p(l=>({...l,preferences:{...l.preferences,musicOk:s}}))}),e.jsx(r,{htmlFor:"music-ok",children:"Music OK"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{id:"quiet-ride",checked:d.preferences.quietRide,onCheckedChange:s=>p(l=>({...l,preferences:{...l.preferences,quietRide:s}}))}),e.jsx(r,{htmlFor:"quiet-ride",children:"Quiet Ride"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{id:"verified-only",checked:d.verifiedOnly,onCheckedChange:s=>p(l=>({...l,verifiedOnly:s}))}),e.jsx(r,{htmlFor:"verified-only",children:"Verified Drivers Only"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(g,{id:"instant-book",checked:d.instantBook,onCheckedChange:s=>p(l=>({...l,instantBook:s}))}),e.jsx(r,{htmlFor:"instant-book",children:"Instant Book"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(o,{variant:"outline",onClick:()=>p({priceRange:[0,200],minRating:4,verifiedOnly:!1,instantBook:!1,preferences:{noSmoking:!1,petsAllowed:!1,musicOk:!1,quietRide:!1}}),children:"Reset Filters"}),e.jsx(o,{onClick:()=>T(!1),children:"Apply Filters"})]})]})]})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{children:"Available Rides"}),u&&e.jsx("p",{children:"Loading rides..."}),!u&&D.length===0&&e.jsx("p",{children:"No rides found. Try changing your search criteria."}),e.jsx("div",{className:"space-y-4",children:D.map(s=>e.jsx(k,{className:"hover:shadow-md transition-shadow",children:e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{children:s.driver?.initials||"DR"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.driver?.name||"Unknown Driver"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(_,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:s.driver?.rating||"New"}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[s.driver?.trips||0," trips"]})]})]})]}),e.jsx("div",{className:"flex-1 flex items-center gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"font-medium",children:s.from}),e.jsx(pe,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"font-medium",children:s.to})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600",children:[e.jsx("span",{children:s.departure_date}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:s.departure_time}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[s.available_seats," seats left"]})]})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl text-primary",children:["$",s.price_per_seat]}),e.jsx("p",{className:"text-sm text-gray-500",children:"per seat"})]}),s.type&&e.jsx(z,{variant:s.type==="wasel"?"default":"secondary",children:s.type==="wasel"?"Wasel (ÙˆØ§ØµÙ„)":"Raje3 (Ø±Ø§Ø¬Ø¹)"}),e.jsx(o,{className:"bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>P(s),children:"View Details"})]})]})})},s.id))})]}),e.jsx(be,{trip:L,open:$,onClose:()=>y(!1),onBook:E})]})}export{Ke as FindRide};
