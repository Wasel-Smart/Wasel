import{r as f,j as e}from"./vendor-ui-jVyU-rC5.js";import{c as K,B as v,D as U,C as m,f as N}from"./index-BMnkv4Hv.js";import{T as O,a as F,b as y,c as b}from"./tabs-DTt9RDMA.js";import{T as Y}from"./trending-up-CP4LsNPw.js";import{A as T,a as q}from"./arrow-up-right-CEIZHkRo.js";import{M as H}from"./map-pin-D34BJ92p.js";import{D as J}from"./dollar-sign-BL2Ijtbm.js";import{C as I}from"./car-DYK4QAKb.js";import{U as W}from"./user-Dvm2u0Fu.js";import{S as C}from"./star-CndAMHYD.js";import{R as u,B as X,C as A,X as M,Y as k,T as g,L as E,a as _,b as $,c as R,P as z,d as L,e as P}from"./vendor-charts-JeMDufhC.js";import"./vendor-react-7PqXWhc5.js";import"./vendor-utils-CADQ8aCF.js";import"./vendor-supabase-b92lme3K.js";import"./vendor-animation-BozBRtxF.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]],Q=K("leaf",G);class V{calculateAnalytics(r){const n=r.filter(c=>c.status==="completed"),o=n.length,a=n.reduce((c,h)=>c+h.distance,0),s=n.filter(c=>c.role==="passenger"),t=n.filter(c=>c.role==="driver"),i=s.reduce((c,h)=>c+h.price,0),x=t.reduce((c,h)=>c+h.price,0),j=a*.12,l=n.filter(c=>c.rating),d=l.length>0?l.reduce((c,h)=>c+(h.rating||0),0)/l.length:0,D=this.calculateMonthlyData(n),w=this.calculateTopRoutes(n),p=this.calculateCategoryBreakdown(n);return{totalTrips:o,totalDistance:Math.round(a),totalSpent:Math.round(i),totalEarned:Math.round(x),carbonSaved:Math.round(j*10)/10,averageRating:Math.round(d*10)/10,totalRides:s.length,totalDrives:t.length,monthlyData:D,topRoutes:w,categoryBreakdown:p}}calculateMonthlyData(r){const n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],o=new Date,a=new Map;for(let s=5;s>=0;s--){const t=new Date(o.getFullYear(),o.getMonth()-s,1),i=`${n[t.getMonth()]} ${t.getFullYear()}`;a.set(i,{month:i,trips:0,spent:0,earned:0,distance:0})}return r.forEach(s=>{const t=new Date(s.date),i=`${n[t.getMonth()]} ${t.getFullYear()}`,x=a.get(i);x&&(x.trips++,x.distance+=s.distance,s.role==="passenger"?x.spent+=s.price:x.earned+=s.price)}),Array.from(a.values())}calculateTopRoutes(r){const n=new Map;return r.forEach(a=>{const s=`${a.from} → ${a.to}`,t=n.get(s);t?(t.count++,t.totalPrice+=a.price,a.date>t.lastUsed&&(t.lastUsed=a.date)):n.set(s,{count:1,totalPrice:a.price,lastUsed:a.date})}),Array.from(n.entries()).map(([a,s])=>({route:a,count:s.count,avgPrice:Math.round(s.totalPrice/s.count),lastUsed:s.lastUsed})).sort((a,s)=>s.count-a.count).slice(0,5)}calculateCategoryBreakdown(r){const n=r.filter(s=>s.type==="wasel").length,o=r.filter(s=>s.type==="raje3").length,a={morning:0,afternoon:0,evening:0,night:0};return r.forEach(s=>{const t=new Date(s.date).getHours();t>=6&&t<12?a.morning++:t>=12&&t<17?a.afternoon++:t>=17&&t<21?a.evening++:a.night++}),{wasel:n,raje3:o,byTime:a}}generateExpenseReport(r,n,o){const a=r.filter(t=>t.status==="completed"&&t.role==="passenger"&&t.date>=n&&t.date<=o);let s=`Wassel Expense Report
`;return s+=`Period: ${n.toLocaleDateString()} - ${o.toLocaleDateString()}

`,s+=`Total Trips: ${a.length}
`,s+=`Total Amount: ${a.reduce((t,i)=>t+i.price,0)} AED

`,s+=`Breakdown:
`,s+=`Date		Route				Amount
`,s+=`${"=".repeat(60)}
`,a.forEach(t=>{s+=`${t.date.toLocaleDateString()}	${t.from} → ${t.to}		${t.price} AED
`}),s}getMockTripHistory(){const r=new Date;return[{id:"1",type:"wasel",role:"passenger",from:"Dubai Marina",to:"Downtown Dubai",date:new Date(r.getTime()-2880*60*1e3),price:35,distance:15,rating:5,status:"completed"},{id:"2",type:"raje3",role:"driver",from:"Abu Dhabi",to:"Dubai",date:new Date(r.getTime()-7200*60*1e3),price:120,distance:140,rating:4.8,status:"completed"},{id:"3",type:"wasel",role:"passenger",from:"Sharjah",to:"Dubai Airport",date:new Date(r.getTime()-10080*60*1e3),price:45,distance:25,rating:4.5,status:"completed"},{id:"4",type:"wasel",role:"driver",from:"Dubai Marina",to:"Mall of Emirates",date:new Date(r.getTime()-14400*60*1e3),price:25,distance:8,rating:5,status:"completed"},{id:"5",type:"raje3",role:"passenger",from:"Dubai",to:"Al Ain",date:new Date(r.getTime()-360*60*60*1e3),price:80,distance:160,rating:4.9,status:"completed"},{id:"6",type:"wasel",role:"passenger",from:"Business Bay",to:"Dubai Marina",date:new Date(r.getTime()-480*60*60*1e3),price:30,distance:12,rating:4.7,status:"completed"},{id:"7",type:"wasel",role:"driver",from:"Jumeirah",to:"Downtown Dubai",date:new Date(r.getTime()-600*60*60*1e3),price:28,distance:10,rating:5,status:"completed"},{id:"8",type:"raje3",role:"passenger",from:"Dubai",to:"Abu Dhabi",date:new Date(r.getTime()-720*60*60*1e3),price:100,distance:140,rating:4.6,status:"completed"},{id:"9",type:"wasel",role:"passenger",from:"Dubai Marina",to:"Downtown Dubai",date:new Date(r.getTime()-840*60*60*1e3),price:35,distance:15,rating:4.8,status:"completed"},{id:"10",type:"wasel",role:"driver",from:"Dubai Internet City",to:"Dubai Mall",date:new Date(r.getTime()-960*60*60*1e3),price:32,distance:18,rating:5,status:"completed"}]}}const S=new V;function pe(){const[B,r]=f.useState("overview"),[n,o]=f.useState("month"),a=f.useMemo(()=>S.getMockTripHistory(),[]),s=f.useMemo(()=>S.calculateAnalytics(a),[a]),t=()=>{const l=new Date;l.setMonth(l.getMonth()-1);const d=S.generateExpenseReport(a,l,new Date),D=new Blob([d],{type:"text/plain"}),w=URL.createObjectURL(D),p=document.createElement("a");p.href=w,p.download="wassel-expense-report.txt",p.click()},i=["#008080","#607D4B","#880044","#00a6a6"],x=[{name:"Morning",value:s.categoryBreakdown.byTime.morning,fill:i[0]},{name:"Afternoon",value:s.categoryBreakdown.byTime.afternoon,fill:i[1]},{name:"Evening",value:s.categoryBreakdown.byTime.evening,fill:i[2]},{name:"Night",value:s.categoryBreakdown.byTime.night,fill:i[3]}],j=[{name:"Wasel",value:s.categoryBreakdown.wasel,fill:i[0]},{name:"Raje3",value:s.categoryBreakdown.raje3,fill:i[1]}];return e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Trip Analytics"}),e.jsx("p",{className:"text-muted-foreground",children:"Track your riding patterns and expenses"})]}),e.jsxs(v,{onClick:t,children:[e.jsx(U,{className:"size-4 mr-2"}),"Export Report"]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(m,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"size-10 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(Y,{className:"size-5 text-primary"})}),e.jsxs(N,{variant:"outline",className:"gap-1",children:[e.jsx(T,{className:"size-3"}),"12%"]})]}),e.jsx("div",{className:"text-2xl font-semibold",children:s.totalTrips}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Trips"})]}),e.jsxs(m,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"size-10 rounded-full bg-secondary/10 flex items-center justify-center",children:e.jsx(H,{className:"size-5 text-secondary"})}),e.jsxs(N,{variant:"outline",className:"gap-1",children:[e.jsx(T,{className:"size-3"}),"8%"]})]}),e.jsxs("div",{className:"text-2xl font-semibold",children:[s.totalDistance," km"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Distance Traveled"})]}),e.jsxs(m,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"size-10 rounded-full bg-accent/10 flex items-center justify-center",children:e.jsx(J,{className:"size-5 text-accent"})}),e.jsxs(N,{variant:"outline",className:"gap-1 text-green-600",children:[e.jsx(q,{className:"size-3"}),"5%"]})]}),e.jsxs("div",{className:"text-2xl font-semibold",children:[s.totalSpent," AED"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Spent"})]}),e.jsxs(m,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"size-10 rounded-full bg-green-100 flex items-center justify-center",children:e.jsx(Q,{className:"size-5 text-green-600"})}),e.jsxs(N,{variant:"outline",className:"gap-1 text-green-600",children:[e.jsx(T,{className:"size-3"}),"15%"]})]}),e.jsxs("div",{className:"text-2xl font-semibold",children:[s.carbonSaved," kg"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"CO₂ Saved"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs(m,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(I,{className:"size-5 text-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"As Driver"})]}),e.jsxs("div",{className:"text-xl font-semibold",children:[s.totalDrives," trips"]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Earned: ",e.jsxs("span",{className:"font-semibold text-green-600",children:[s.totalEarned," AED"]})]})]}),e.jsxs(m,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(W,{className:"size-5 text-secondary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"As Passenger"})]}),e.jsxs("div",{className:"text-xl font-semibold",children:[s.totalRides," trips"]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Spent: ",e.jsxs("span",{className:"font-semibold text-accent",children:[s.totalSpent," AED"]})]})]}),e.jsxs(m,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(C,{className:"size-5 text-amber-500"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Average Rating"})]}),e.jsxs("div",{className:"text-xl font-semibold",children:[s.averageRating," / 5.0"]}),e.jsx("div",{className:"flex gap-1 mt-2",children:[1,2,3,4,5].map(l=>e.jsx(C,{className:`size-4 ${l<=Math.round(s.averageRating)?"fill-amber-500 text-amber-500":"text-gray-300"}`},l))})]})]}),e.jsxs(O,{value:B,onValueChange:r,children:[e.jsxs(F,{className:"grid w-full grid-cols-4",children:[e.jsx(y,{value:"overview",children:"Overview"}),e.jsx(y,{value:"trends",children:"Trends"}),e.jsx(y,{value:"routes",children:"Top Routes"}),e.jsx(y,{value:"breakdown",children:"Breakdown"})]}),e.jsxs(b,{value:"overview",className:"space-y-4",children:[e.jsxs(m,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{children:"Monthly Activity"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{variant:n==="month"?"default":"outline",size:"sm",onClick:()=>o("month"),children:"Month"}),e.jsx(v,{variant:n==="quarter"?"default":"outline",size:"sm",onClick:()=>o("quarter"),children:"Quarter"}),e.jsx(v,{variant:n==="year"?"default":"outline",size:"sm",onClick:()=>o("year"),children:"Year"})]})]}),e.jsx(u,{width:"100%",height:300,children:e.jsxs(X,{data:s.monthlyData,children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(M,{dataKey:"month"}),e.jsx(k,{}),e.jsx(g,{}),e.jsx(E,{}),e.jsx(_,{dataKey:"trips",fill:"#008080",name:"Trips"})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs(m,{className:"p-6",children:[e.jsx("h3",{className:"mb-4",children:"Spending & Earnings"}),e.jsx(u,{width:"100%",height:250,children:e.jsxs($,{data:s.monthlyData,children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(M,{dataKey:"month"}),e.jsx(k,{}),e.jsx(g,{}),e.jsx(E,{}),e.jsx(R,{type:"monotone",dataKey:"spent",stroke:"#880044",name:"Spent (AED)"}),e.jsx(R,{type:"monotone",dataKey:"earned",stroke:"#607D4B",name:"Earned (AED)"})]})})]}),e.jsxs(m,{className:"p-6",children:[e.jsx("h3",{className:"mb-4",children:"Distance Traveled"}),e.jsx(u,{width:"100%",height:250,children:e.jsxs($,{data:s.monthlyData,children:[e.jsx(A,{strokeDasharray:"3 3"}),e.jsx(M,{dataKey:"month"}),e.jsx(k,{}),e.jsx(g,{}),e.jsx(E,{}),e.jsx(R,{type:"monotone",dataKey:"distance",stroke:"#008080",name:"Distance (km)"})]})})]})]})]}),e.jsx(b,{value:"trends",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs(m,{className:"p-6",children:[e.jsx("h3",{className:"mb-4",children:"Trips by Time of Day"}),e.jsx(u,{width:"100%",height:300,children:e.jsxs(z,{children:[e.jsx(L,{data:x,cx:"50%",cy:"50%",labelLine:!1,label:({name:l,percent:d})=>`${l} ${(d*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:x.map((l,d)=>e.jsx(P,{fill:l.fill},`cell-${d}`))}),e.jsx(g,{})]})})]}),e.jsxs(m,{className:"p-6",children:[e.jsx("h3",{className:"mb-4",children:"Trip Types"}),e.jsx(u,{width:"100%",height:300,children:e.jsxs(z,{children:[e.jsx(L,{data:j,cx:"50%",cy:"50%",labelLine:!1,label:({name:l,percent:d})=>`${l} ${(d*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:j.map((l,d)=>e.jsx(P,{fill:l.fill},`cell-${d}`))}),e.jsx(g,{})]})})]})]})}),e.jsx(b,{value:"routes",children:e.jsxs(m,{className:"p-6",children:[e.jsx("h3",{className:"mb-4",children:"Most Frequent Routes"}),e.jsx("div",{className:"space-y-3",children:s.topRoutes.map((l,d)=>e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-muted rounded-lg",children:[e.jsx("div",{className:"size-10 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsxs("span",{className:"font-semibold text-primary",children:["#",d+1]})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold",children:l.route}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[l.count," trips · Avg ",l.avgPrice," AED"]})]}),e.jsxs("div",{className:"text-right text-sm text-muted-foreground",children:["Last: ",l.lastUsed.toLocaleDateString()]})]},d))})]})}),e.jsx(b,{value:"breakdown",children:e.jsxs(m,{className:"p-6",children:[e.jsx("h3",{className:"mb-4",children:"Detailed Breakdown"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Net Balance"}),e.jsxs("p",{className:"text-2xl font-semibold text-green-600",children:["+",s.totalEarned-s.totalSpent," AED"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Earned ",s.totalEarned," AED · Spent ",s.totalSpent," AED"]})]}),e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Average per Trip"}),e.jsxs("p",{className:"text-2xl font-semibold",children:[Math.round((s.totalSpent+s.totalEarned)/s.totalTrips)," AED"]})]}),e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("p",{className:"text-sm text-green-700 mb-1",children:"Environmental Impact"}),e.jsxs("p",{className:"text-2xl font-semibold text-green-700",children:[s.carbonSaved," kg CO₂"]}),e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["Equivalent to planting ",Math.round(s.carbonSaved/20)," trees"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Trip Distribution"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"As Driver"}),e.jsxs("span",{className:"font-semibold",children:[Math.round(s.totalDrives/s.totalTrips*100),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"As Passenger"}),e.jsxs("span",{className:"font-semibold",children:[Math.round(s.totalRides/s.totalTrips*100),"%"]})]})]})]}),e.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Type Distribution"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Wasel (One-way)"}),e.jsxs("span",{className:"font-semibold",children:[Math.round(s.categoryBreakdown.wasel/s.totalTrips*100),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Raje3 (Return)"}),e.jsxs("span",{className:"font-semibold",children:[Math.round(s.categoryBreakdown.raje3/s.totalTrips*100),"%"]})]})]})]})]})]})]})})]})]})}export{pe as TripAnalytics};
