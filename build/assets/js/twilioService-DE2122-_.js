var a={};function i(){const r=a.REACT_APP_TWILIO_ACCOUNT_SID||"",s=a.REACT_APP_TWILIO_AUTH_TOKEN||"",t=a.REACT_APP_TWILIO_PHONE_NUMBER||"";return!r||!s?null:{accountSid:r,authToken:s,phoneNumber:t}}const d={async sendSMS(r,s){if(!i())return console.log(`[Mock SMS] To: ${r}, Message: ${s}`),{success:!0,messageSid:`SM_mock_${Date.now()}`};try{const e=await fetch("/api/twilio/send-sms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:r,message:s})});return e.ok?{success:!0,messageSid:(await e.json()).messageSid}:{success:!1,error:(await e.json()).message||"Failed to send SMS"}}catch(e){return console.error("SMS send failed:",e),{success:!1,error:e.message}}},async sendEmergencySMS(r,s,t,e){const o=`https://www.google.com/maps?q=${s.lat},${s.lng}`,n=`ðŸš¨ EMERGENCY ALERT from ${e}

Trip ID: ${t.slice(0,8)}
Location: ${o}

Please check on them immediately or contact emergency services.`;let c=0,l=0;for(const f of r)(await this.sendSMS(f.phone,n)).success?c++:l++;return{sent:c,failed:l}},async initiateCall(r,s){if(!i())return console.log(`[Mock Call] From: ${r} to ${s}`),{success:!0,callSid:`CA_mock_${Date.now()}`};try{const e=await fetch("/api/twilio/initiate-call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({from:r,to:s})});return e.ok?{success:!0,callSid:(await e.json()).callSid}:{success:!1,error:(await e.json()).message||"Failed to initiate call"}}catch(e){return console.error("Call initiation failed:",e),{success:!1,error:e.message}}},async createConferenceCall(r,s,t){if(!i())return console.log(`[Mock Conference] Driver: ${r}, Passenger: ${s}`),{success:!0,conferenceSid:`CF_mock_${Date.now()}`};try{const o=await fetch("/api/twilio/create-conference",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({driverPhone:r,passengerPhone:s,tripId:t})});return o.ok?{success:!0,conferenceSid:(await o.json()).conferenceSid}:{success:!1,error:(await o.json()).message||"Failed to create conference"}}catch(o){return console.error("Conference call failed:",o),{success:!1,error:o.message}}},async sendVerificationCode(r,s){const t=`Your Wassel verification code is: ${s}

This code will expire in 10 minutes.`,e=await this.sendSMS(r,t);return{success:e.success,error:e.error}}};export{d as twilioService};
