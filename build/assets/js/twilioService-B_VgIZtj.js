import{INTEGRATION_CONFIG as a}from"./integrations-CUA0pWDL.js";var i={};function l(){const o=i.REACT_APP_TWILIO_ACCOUNT_SID||"",s=i.REACT_APP_TWILIO_AUTH_TOKEN||"",t=i.REACT_APP_TWILIO_PHONE_NUMBER||"";return!o||!s?null:{accountSid:o,authToken:s,phoneNumber:t}}const g={async sendSMS(o,s){if(!l()||!a.twilio.enabled)return console.log(`[Mock SMS] To: ${o}, Message: ${s}`),{success:!0,messageSid:`SM_mock_${Date.now()}`};try{const e=await fetch("/api/twilio/send-sms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:o,message:s})});return e.ok?{success:!0,messageSid:(await e.json()).messageSid}:{success:!1,error:(await e.json()).message||"Failed to send SMS"}}catch(e){return console.error("SMS send failed:",e),{success:!1,error:e.message}}},async sendEmergencySMS(o,s,t,e){const r=`https://www.google.com/maps?q=${s.lat},${s.lng}`,n=`ðŸš¨ EMERGENCY ALERT from ${e}

Trip ID: ${t.slice(0,8)}
Location: ${r}

Please check on them immediately or contact emergency services.`;let c=0,d=0;for(const u of o)(await this.sendSMS(u.phone,n)).success?c++:d++;return{sent:c,failed:d}},async initiateCall(o,s){if(!l()||!a.twilio.enabled)return console.log(`[Mock Call] From: ${o} to ${s}`),{success:!0,callSid:`CA_mock_${Date.now()}`};try{const e=await fetch("/api/twilio/initiate-call",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({from:o,to:s})});return e.ok?{success:!0,callSid:(await e.json()).callSid}:{success:!1,error:(await e.json()).message||"Failed to initiate call"}}catch(e){return console.error("Call initiation failed:",e),{success:!1,error:e.message}}},async createConferenceCall(o,s,t){if(!l()||!a.twilio.enabled)return console.log(`[Mock Conference] Driver: ${o}, Passenger: ${s}`),{success:!0,conferenceSid:`CF_mock_${Date.now()}`};try{const r=await fetch("/api/twilio/create-conference",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({driverPhone:o,passengerPhone:s,tripId:t})});return r.ok?{success:!0,conferenceSid:(await r.json()).conferenceSid}:{success:!1,error:(await r.json()).message||"Failed to create conference"}}catch(r){return console.error("Conference call failed:",r),{success:!1,error:r.message}}},async sendVerificationCode(o,s){const t=`Your Wassel verification code is: ${s}

This code will expire in 10 minutes.`,e=await this.sendSMS(o,t);return{success:e.success,error:e.error}}};export{g as twilioService};
