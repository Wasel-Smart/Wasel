import{r,j as e}from"./vendor-ui-jVyU-rC5.js";import{c as k,C as m,e as p,B as n,A as M,m as C,f as R,t as i}from"./index-DyAvE2yn.js";import{M as T}from"./MapComponent-W-VMxfMP.js";import{S as _}from"./ServiceTabs-BBvoq0LN.js";import{d as f}from"./mockDataService-CJlUMX2z.js";import{B as o}from"./bike-Buuhu8pj.js";import{N as A}from"./navigation-BTKs6Jj_.js";import{Z as E}from"./zap-LHlXbtf4.js";import"./vendor-react-7PqXWhc5.js";import"./vendor-utils-CADQ8aCF.js";import"./vendor-supabase-b92lme3K.js";import"./vendor-animation-BozBRtxF.js";import"./tabs-DMlsRxVi.js";import"./PackageDelivery-BFfZTBOa.js";import"./input-BLo5ngIr.js";import"./label-B-5E83zk.js";import"./radio-group-D0K9z-UY.js";import"./ImageWithFallback-BQYHVVBG.js";import"./locate-DM14SJBn.js";import"./truck-C-mU8ZzE.js";import"./calendar-clock-CaSado1o.js";import"./scan-search-B_3Ey2Fy.js";import"./circle-dollar-sign-WuyUeWYe.js";import"./shield-C2jQBPX_.js";import"./FindRide-eAlN9c6x.js";import"./dialog-BDXIbl4w.js";import"./avatar-mc1vfE_1.js";import"./sparkles-BX1RYZZT.js";import"./smartphone-BU3Aqk_J.js";import"./timer-BQYySkTv.js";import"./users-round-Dx08XuI4.js";import"./useTrips-BZOsvcTG.js";import"./move-right-BqwhuyDP.js";import"./OfferRide-DXzaXgDb.js";import"./textarea-DMwQFIld.js";import"./switch-DSuvZZWB.js";import"./circle-plus-pTcp353Q.js";import"./radar-C4Jwe47A.js";import"./trending-up-DPYKOFyR.js";import"./search-LMXV5M4z.js";import"./users-Brk4-fle.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],j=k("scan",P),b=[{id:"1",code:"WAS-001",battery:85,range:25,lat:25.2048,lng:55.2708,pricePerMin:1,status:"available"},{id:"2",code:"WAS-002",battery:42,range:12,lat:25.204,lng:55.2715,pricePerMin:1,status:"available"},{id:"3",code:"WAS-003",battery:15,range:4,lat:25.2055,lng:55.272,pricePerMin:1,status:"low-battery"},{id:"4",code:"WAS-004",battery:92,range:28,lat:25.2035,lng:55.2695,pricePerMin:1,status:"available"}];function Ne(){const[s,l]=r.useState(null),[x,c]=r.useState(!1),[a,h]=r.useState(null),[u,g]=r.useState(0);r.useEffect(()=>{let t;return a&&(t=setInterval(()=>{g(Math.floor((Date.now()-a.startTime)/1e3))},1e3)),()=>clearInterval(t)},[a]);const v=async()=>{if(s){c(!0);try{const t=await f.createRental({vehicle_id:s.id,vehicle_name:`Scooter ${s.code}`,pickup_location:"Current Location",return_location:"Current Location",pickup_date:new Date().toISOString().split("T")[0],return_date:new Date().toISOString().split("T")[0],total_cost:0});setTimeout(()=>{c(!1),h({startTime:Date.now(),scooter:s}),i.success("Scooter unlocked! Enjoy your ride."),l(null)},2e3)}catch(t){c(!1),i.error(t.message||"Failed to unlock scooter")}}},N=async()=>{if(!a)return;const t=Math.ceil(u/60)*a.scooter.pricePerMin;try{await f.updateTrip(a.scooter.id,{price_per_seat:t}),i.success(`Ride ended. Total: AED ${t.toFixed(2)}. Payment processed.`),h(null),g(0)}catch(d){i.error(d.message||"Failed to end ride")}},y=t=>{const d=Math.floor(t/60),S=t%60;return`${d}:${S.toString().padStart(2,"0")}`},w=e.jsxs("div",{className:"h-[calc(100vh-80px)] flex flex-col relative bg-gray-50 dark:bg-gray-900",children:[e.jsxs("div",{className:"flex-1 relative z-0",children:[e.jsx(T,{className:"w-full h-full"}),e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:b.map(t=>e.jsx("div",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 cursor-pointer pointer-events-auto transition-transform hover:scale-110",style:{top:`${50+(t.lat-25.2048)*1e3}%`,left:`${50+(t.lng-55.2708)*1e3}%`},onClick:()=>l(t),children:e.jsx("div",{className:`
                w-10 h-10 rounded-full flex items-center justify-center shadow-lg border-2 border-white
                ${t.status==="low-battery"?"bg-red-500":"bg-green-500"}
              `,children:e.jsx(o,{className:"w-5 h-5 text-white"})})},t.id))})]}),e.jsxs("div",{className:"absolute top-4 left-4 right-4 z-10 flex justify-between pointer-events-none",children:[e.jsx(m,{className:"pointer-events-auto bg-white/90 backdrop-blur-md shadow-lg border-0",children:e.jsxs(p,{className:"p-4 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(o,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm",children:"Nearby Scooters"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[b.filter(t=>t.status==="available").length," available"]})]})]})}),a&&e.jsx(m,{className:"pointer-events-auto bg-green-600 text-white shadow-lg border-0 animate-pulse",children:e.jsxs(p,{className:"p-4 flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-100 uppercase font-bold",children:"Ride Time"}),e.jsx("p",{className:"font-mono text-2xl font-bold",children:y(u)})]}),e.jsx(n,{variant:"secondary",size:"sm",onClick:N,className:"bg-white text-green-700 hover:bg-green-50",children:"End Ride"})]})})]}),e.jsx(M,{children:s&&!a&&e.jsx(C.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},className:"absolute bottom-4 left-4 right-4 z-20",children:e.jsx(m,{className:"bg-white/95 backdrop-blur-xl shadow-2xl border-0",children:e.jsxs(p,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center",children:e.jsx(o,{className:"w-8 h-8 text-green-600"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[s.code,e.jsxs(R,{variant:s.battery>20?"default":"destructive",className:"text-xs",children:[s.battery,"% Battery"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(A,{className:"w-3 h-3"})," ",s.range,"km range"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(E,{className:"w-3 h-3"})," Electronic"]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-2xl font-bold text-primary",children:["AED ",s.pricePerMin]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"per min"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(n,{className:"flex-1 h-12 text-lg bg-green-600 hover:bg-green-700",onClick:v,disabled:x||s.status==="low-battery",children:x?e.jsx("span",{className:"animate-pulse",children:"Unlocking..."}):e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"mr-2 w-5 h-5"}),s.status==="low-battery"?"Low Battery":"Scan to Unlock"]})}),e.jsx(n,{variant:"outline",className:"h-12 aspect-square",onClick:()=>l(null),children:"X"})]})]})})})}),!s&&!a&&e.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 z-10",children:e.jsxs(n,{size:"lg",className:"h-16 rounded-full px-8 shadow-2xl bg-gradient-to-r from-green-500 to-emerald-600 hover:scale-105 transition-transform",onClick:()=>i.info("Point camera at scooter QR code"),children:[e.jsx(j,{className:"mr-2 w-6 h-6"}),"Scan to Ride"]})})]});return e.jsx(_,{mainService:w,mainServiceTitle:"Scooter Rentals",mainServiceIcon:e.jsx(o,{className:"w-4 h-4"}),showAllTabs:!0})}export{Ne as ScooterRentals};
