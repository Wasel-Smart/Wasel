import{r as t,j as e}from"./vendor-ui-jVyU-rC5.js";import{c as B,u as I,r as U,v as w,C as c,e as n,G as z,a as p,b as f,d as u,B as j,l as i,P as H,f as v,t as l}from"./index-DyAvE2yn.js";import{I as b}from"./input-BLo5ngIr.js";import{U as J}from"./users-Brk4-fle.js";import{D as L}from"./dollar-sign-CMLAjk1Q.js";import{S as M}from"./share-2-Z_7cU2iQ.js";import"./vendor-react-7PqXWhc5.js";import"./vendor-utils-CADQ8aCF.js";import"./vendor-supabase-b92lme3K.js";import"./vendor-animation-BozBRtxF.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Y=B("copy",O),C=`https://${U}.supabase.co/functions/v1/make-server-0b1f4071`;function se(){const{user:m,session:y}=I(),[o,E]=t.useState(""),[a,A]=t.useState(0),[R,k]=t.useState(0),[S,D]=t.useState(!0),[h,g]=t.useState("");t.useEffect(()=>{m?.id&&T()},[m?.id]);const T=async()=>{try{const s=await fetch(`${C}/referral/${m?.id}`,{headers:{Authorization:`Bearer ${y?.access_token||w}`}}),r=await s.json();s.ok&&(E(r.referral_code),A(r.referral_count),k(r.referral_earnings))}catch(s){console.error("Error fetching referral data:",s)}finally{D(!1)}},N=()=>{navigator.clipboard.writeText(o),l.success("Referral code copied to clipboard!")},_=async()=>{const s={title:"Join Wassel - ÙˆØ§ØµÙ„",text:`Join me on Wassel and get AED 10 free! Use my referral code: ${o}`,url:`https://wassel.app?ref=${o}`};try{navigator.share?(await navigator.share(s),l.success("Shared successfully!")):N()}catch(r){console.error("Error sharing:",r)}},$=async()=>{if(!h.trim()){l.error("Please enter a referral code");return}try{const s=await fetch(`${C}/referral/apply`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y?.access_token||w}`},body:JSON.stringify({referral_code:h.toUpperCase()})}),r=await s.json();s.ok?(l.success(r.message),g("")):l.error(r.error)}catch{l.error("Failed to apply referral code")}},d=[{count:1,reward:20,icon:"ðŸŽ‰"},{count:5,reward:100,icon:"ðŸŒŸ"},{count:10,reward:250,icon:"ðŸ’Ž"},{count:25,reward:750,icon:"ðŸ‘‘"},{count:50,reward:2e3,icon:"ðŸ†"}],x=d.find(s=>s.count>a)||d[d.length-1],P=a/x.count*100;return S?e.jsx("div",{className:"flex justify-center p-8",children:"Loading..."}):e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-3xl",children:"Referral Program"}),e.jsx("p",{className:"text-muted-foreground",children:"Invite friends and earn rewards together! Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„Ø¥Ø­Ø§Ù„Ø©"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(c,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Referrals"}),e.jsx("p",{className:"text-3xl",children:a})]}),e.jsx(J,{className:"w-10 h-10 text-primary"})]})})}),e.jsx(c,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Earnings"}),e.jsxs("p",{className:"text-3xl",children:["AED ",R]})]}),e.jsx(L,{className:"w-10 h-10 text-secondary"})]})})}),e.jsx(c,{children:e.jsx(n,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Per Referral"}),e.jsx("p",{className:"text-3xl",children:"AED 20"})]}),e.jsx(z,{className:"w-10 h-10 text-accent"})]})})})]}),e.jsxs(c,{children:[e.jsxs(p,{children:[e.jsx(f,{children:"Your Referral Code"}),e.jsx(u,{children:"Share this code with friends to earn rewards"})]}),e.jsxs(n,{className:"space-y-4",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx(b,{value:o,readOnly:!0,className:"text-2xl text-center tracking-widest bg-muted"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{onClick:N,className:"flex-1 bg-primary hover:bg-primary/90 text-primary-foreground",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Copy Code"]}),e.jsxs(j,{onClick:_,variant:"outline",className:"flex-1",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Share"]})]}),e.jsxs("div",{className:"bg-primary/5 border border-primary/20 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"How it works:"}),e.jsxs("ul",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(i,{className:"w-4 h-4 mt-0.5 text-primary"}),e.jsx("span",{children:"Your friend signs up with your referral code"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(i,{className:"w-4 h-4 mt-0.5 text-primary"}),e.jsx("span",{children:"They get AED 10 added to their wallet instantly"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(i,{className:"w-4 h-4 mt-0.5 text-primary"}),e.jsx("span",{children:"You get AED 20 added to your wallet"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(i,{className:"w-4 h-4 mt-0.5 text-primary"}),e.jsx("span",{children:"No limit on how many friends you can refer!"})]})]})]})]})]}),e.jsxs(c,{children:[e.jsxs(p,{children:[e.jsx(f,{children:"Have a Referral Code?"}),e.jsx(u,{children:"Enter your friend's code to get AED 10 bonus"})]}),e.jsx(n,{className:"space-y-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{value:h,onChange:s=>g(s.target.value.toUpperCase()),placeholder:"Enter referral code",className:"text-center tracking-wider"}),e.jsx(j,{onClick:$,className:"bg-primary hover:bg-primary/90 text-primary-foreground",children:"Apply Code"})]})})]}),e.jsxs(c,{children:[e.jsxs(p,{children:[e.jsx(f,{children:"Referral Milestones"}),e.jsx(u,{children:"Reach milestones to unlock bonus rewards"})]}),e.jsxs(n,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{children:[a," referrals"]}),e.jsxs("span",{className:"text-muted-foreground",children:["Next: ",x.count," referrals"]})]}),e.jsx(H,{value:P,className:"h-2"}),e.jsxs("p",{className:"text-sm text-muted-foreground text-center",children:[x.count-a," more to unlock AED ",x.reward," bonus!"]})]}),e.jsx("div",{className:"space-y-3",children:d.map(s=>{const r=a>=s.count;return e.jsxs("div",{className:`flex items-center justify-between p-4 rounded-lg border ${r?"bg-primary/5 border-primary/30":"bg-muted/30"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-3xl",children:s.icon}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[s.count," Referrals"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Unlock AED ",s.reward," bonus"]})]})]}),r?e.jsxs(v,{variant:"default",className:"bg-primary",children:[e.jsx(i,{className:"w-3 h-3 mr-1"}),"Achieved"]}):e.jsxs(v,{variant:"outline",children:[s.count-a," more"]})]},s.count)})})]})]})]})}export{se as ReferralProgram};
