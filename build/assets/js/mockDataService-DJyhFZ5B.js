import{h as d,F as c}from"./index-CcjVERrS.js";class p{trips=[];bookings=[];rentals=[];nextTripId=1;nextBookingId=1;nextRentalId=1;constructor(){this.initializeMockData()}initializeMockData(){this.trips=[{id:"trip-1",driver_id:"driver-1",driver_name:"Ahmed Al-Mansoori",driver_rating:4.8,driver_photo:"https://i.pravatar.cc/150?img=12",from:"Dubai Marina",to:"Abu Dhabi",from_coords:{lat:25.0772,lng:55.1398},to_coords:{lat:24.4539,lng:54.3773},departure_date:new Date(Date.now()+864e5).toISOString().split("T")[0],departure_time:"08:00",price_per_seat:45,total_seats:4,available_seats:2,trip_type:"wasel",status:"published",vehicle:{make:"Toyota",model:"Camry",year:2022,color:"White",plate_number:"DXB-1234"},preferences:{smoking_allowed:!1,pets_allowed:!0,music_allowed:!0},created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"trip-2",driver_id:"driver-2",driver_name:"Sarah Al-Zahra",driver_rating:4.9,driver_photo:"https://i.pravatar.cc/150?img=47",from:"Riyadh",to:"Jeddah",from_coords:{lat:24.7136,lng:46.6753},to_coords:{lat:21.5433,lng:39.1728},departure_date:new Date(Date.now()+1728e5).toISOString().split("T")[0],departure_time:"14:30",price_per_seat:120,total_seats:3,available_seats:1,trip_type:"wasel",status:"published",vehicle:{make:"Honda",model:"Accord",year:2023,color:"Black",plate_number:"RYD-5678"},preferences:{smoking_allowed:!1,pets_allowed:!1,music_allowed:!0},created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"trip-3",driver_id:"driver-3",driver_name:"Mohammed Hassan",driver_rating:4.7,driver_photo:"https://i.pravatar.cc/150?img=33",from:"Cairo",to:"Alexandria",from_coords:{lat:30.0444,lng:31.2357},to_coords:{lat:31.2001,lng:29.9187},departure_date:new Date(Date.now()+2592e5).toISOString().split("T")[0],departure_time:"09:15",price_per_seat:80,total_seats:4,available_seats:3,trip_type:"raje3",status:"published",vehicle:{make:"Nissan",model:"Altima",year:2021,color:"Silver",plate_number:"CAI-9012"},preferences:{smoking_allowed:!1,pets_allowed:!0,music_allowed:!1},created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]}async createTrip(e){const t={id:`trip-${this.nextTripId++}`,driver_id:e.driver_id||"current-user",driver_name:e.driver_name||"You",driver_rating:e.driver_rating||5,from:e.from||"",to:e.to||"",from_coords:e.from_coords||{lat:25.2048,lng:55.2708},to_coords:e.to_coords||{lat:24.4539,lng:54.3773},departure_date:e.departure_date||new Date().toISOString().split("T")[0],departure_time:e.departure_time||"12:00",price_per_seat:e.price_per_seat||50,total_seats:e.total_seats||4,available_seats:e.available_seats||e.total_seats||4,trip_type:e.trip_type||"wasel",status:"published",vehicle:e.vehicle,preferences:e.preferences,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return this.trips.push(t),t}async searchTrips(e){let t=[...this.trips];return e.from&&(t=t.filter(i=>i.from.toLowerCase().includes(e.from.toLowerCase()))),e.to&&(t=t.filter(i=>i.to.toLowerCase().includes(e.to.toLowerCase()))),e.date&&(t=t.filter(i=>i.departure_date===e.date)),e.seats&&(t=t.filter(i=>i.available_seats>=e.seats)),t.filter(i=>i.status==="published")}async getTripById(e){return this.trips.find(t=>t.id===e)||null}async updateTrip(e,t){const i=this.trips.findIndex(s=>s.id===e);return i===-1?null:(this.trips[i]={...this.trips[i],...t,updated_at:new Date().toISOString()},this.trips[i])}async deleteTrip(e){const t=this.trips.findIndex(i=>i.id===e);return t===-1?!1:(this.trips.splice(t,1),!0)}async createBooking(e,t,i,s,o){const a=await this.getTripById(e);if(!a)throw new Error("Trip not found");if(a.available_seats<t)throw new Error("Not enough available seats");const l={id:`booking-${this.nextBookingId++}`,trip_id:e,passenger_id:i||"current-user",passenger_name:"You",seats_requested:t,status:"pending",total_price:a.price_per_seat*t,created_at:new Date().toISOString(),pickup_stop:s,dropoff_stop:o};return a.available_seats-=t,a.updated_at=new Date().toISOString(),this.bookings.push(l),l}async getBookingsByTrip(e){return this.bookings.filter(t=>t.trip_id===e)}async getUserBookings(e){return{bookings:this.bookings.filter(s=>s.passenger_id===e).map(s=>{const o=this.trips.find(a=>a.id===s.trip_id);return{...s,trip:o?{...o,driver_name:o.driver_name,driver_photo:o.driver_photo,driver_rating:o.driver_rating,from:o.from,to:o.to,departure_date:o.departure_date,departure_time:o.departure_time,vehicle:o.vehicle}:null}})}}async createRental(e){const t={id:`rental-${this.nextRentalId++}`,vehicle_id:e.vehicle_id||"vehicle-1",vehicle_name:e.vehicle_name||"Toyota Corolla",user_id:e.user_id||"current-user",pickup_location:e.pickup_location||"",return_location:e.return_location||e.pickup_location||"",pickup_date:e.pickup_date||new Date().toISOString().split("T")[0],return_date:e.return_date||new Date(Date.now()+864e5).toISOString().split("T")[0],total_cost:e.total_cost||150,status:"active"};return this.rentals.push(t),t}async getUserRentals(e){return{rentals:this.rentals.filter(i=>i.user_id===e)}}getAllTrips(){return[...this.trips]}getAllBookings(){return[...this.bookings]}getAllRentals(){return[...this.rentals]}clearAll(){this.trips=[],this.bookings=[],this.rentals=[],this.nextTripId=1,this.nextBookingId=1,this.nextRentalId=1,this.initializeMockData()}}const n=new p,u={async createTrip(r){try{return await c.createTrip(r)}catch{return console.log("[Mock] Creating trip:",r),{trip:await n.createTrip(r)}}},async searchTrips(r){try{return await c.searchTrips(r.from,r.to,r.date,r.seats)}catch{return console.log("[Mock] Searching trips:",r),{trips:await n.searchTrips(r)}}},async getTripById(r){try{return await c.getTripById(r)}catch{return console.log("[Mock] Getting trip:",r),{trip:await n.getTripById(r)}}},async updateTrip(r,e){try{return await c.updateTrip(r,e)}catch{return console.log("[Mock] Updating trip:",r,e),{trip:await n.updateTrip(r,e)}}},async deleteTrip(r){try{return await c.deleteTrip(r)}catch{return console.log("[Mock] Deleting trip:",r),await n.deleteTrip(r),{success:!0}}},async createBooking(r,e,t,i){try{return await d.createBooking(r,e,t,i)}catch{console.log("[Mock] Creating booking:",r,e);const o=await n.createBooking(r,e,void 0,t,i),a=await n.getTripById(r);return{booking:{...o,trip:a?{...a,driver_name:a.driver_name,driver_photo:a.driver_photo,driver_rating:a.driver_rating,from:a.from,to:a.to,departure_date:a.departure_date,departure_time:a.departure_time,vehicle:a.vehicle}:null}}}},async getUserBookings(r){try{return await d.getUserBookings()}catch{return console.log("[Mock] Getting user bookings"),{bookings:await n.getUserBookings(r||"current-user")}}},async createRental(r){return console.log("[Mock] Creating rental:",r),{rental:await n.createRental(r)}},async getUserRentals(r){return console.log("[Mock] Getting user rentals"),{rentals:await n.getUserRentals(r||"current-user")}}};export{u as d};
