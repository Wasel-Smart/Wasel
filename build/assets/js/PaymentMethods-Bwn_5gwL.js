import{r as l,j as e}from"./vendor-ui-jVyU-rC5.js";import{u as v,s as i,B as t,C as o,e as c,f as C,g as u,a as P,b as S,d as A,t as r}from"./index-BMnkv4Hv.js";import{P as f}from"./plus--GDBM4Gl.js";import{S as D}from"./star-CndAMHYD.js";import{T as M}from"./trash-2-B1lTNNME.js";import"./vendor-react-7PqXWhc5.js";import"./vendor-utils-CADQ8aCF.js";import"./vendor-supabase-b92lme3K.js";import"./vendor-animation-BozBRtxF.js";function q(){const{user:d}=v(),[x,y]=l.useState([]),[j,h]=l.useState(!0),[N,n]=l.useState(!1);l.useEffect(()=>{d&&m()},[d]);const m=async()=>{h(!0);try{const{data:s,error:a}=await i.from("payment_methods").select("*").eq("user_id",d?.id);if(a)throw a;y([{id:"1",type:"card",brand:"Visa",last4:"4242",expiryMonth:12,expiryYear:2025,isDefault:!0,holderName:"John Doe"},{id:"2",type:"wallet",isDefault:!1,holderName:"Wassel Wallet"}])}catch(s){console.error("Failed to load payment methods:",s)}finally{h(!1)}},b=async s=>{try{await i.from("payment_methods").update({is_default:!1}).eq("user_id",d?.id),await i.from("payment_methods").update({is_default:!0}).eq("id",s),r.success("Default payment method updated"),m()}catch(a){console.error("Failed to set default:",a),r.error("Failed to update default payment method")}},g=async s=>{if(window.confirm("Are you sure you want to remove this payment method?"))try{await i.from("payment_methods").delete().eq("id",s),r.success("Payment method removed"),m()}catch(p){console.error("Failed to delete payment method:",p),r.error("Failed to remove payment method")}},w=s=>e.jsx(u,{className:"w-8 h-8"});return j?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Payment Methods"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your saved payment methods"})]}),e.jsxs(t,{onClick:()=>n(!0),children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Add Payment Method"]})]}),e.jsxs("div",{className:"space-y-4",children:[x.map(s=>e.jsx(o,{children:e.jsx(c,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[s.type==="card"?w(s.brand):e.jsx("div",{className:"w-8 h-8 bg-primary rounded flex items-center justify-center text-white font-bold",children:"W"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:s.type==="card"?`${s.brand} •••• ${s.last4}`:"Wassel Wallet"}),s.isDefault&&e.jsxs(C,{variant:"default",children:[e.jsx(D,{className:"w-3 h-3 mr-1"}),"Default"]})]}),s.type==="card"&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Expires ",s.expiryMonth,"/",s.expiryYear]}),s.holderName&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.holderName})]})]}),e.jsxs("div",{className:"flex gap-2",children:[!s.isDefault&&e.jsx(t,{variant:"outline",size:"sm",onClick:()=>b(s.id),children:"Set as Default"}),s.type!=="wallet"&&e.jsx(t,{variant:"ghost",size:"sm",onClick:()=>g(s.id),children:e.jsx(M,{className:"w-4 h-4"})})]})]})})},s.id)),x.length===0&&e.jsx(o,{children:e.jsxs(c,{className:"py-12 text-center",children:[e.jsx(u,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No payment methods added"}),e.jsxs(t,{className:"mt-4",onClick:()=>n(!0),children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Add Your First Payment Method"]})]})})]}),N&&e.jsxs(o,{className:"border-2 border-primary",children:[e.jsxs(P,{children:[e.jsx(S,{children:"Add Payment Method"}),e.jsx(A,{children:"Your payment information is encrypted and secure"})]}),e.jsx(c,{children:e.jsxs("div",{className:"p-8 bg-muted rounded-lg text-center",children:[e.jsx(u,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"font-semibold mb-2",children:"Stripe Elements Integration"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["In production, this would load Stripe Elements for secure card input.",e.jsx("br",{}),"Add REACT_APP_STRIPE_PUBLISHABLE_KEY to enable."]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx(t,{onClick:()=>{r.info("Stripe integration ready. Add API key to enable."),n(!1)},children:"Add Card (Demo)"}),e.jsx(t,{variant:"outline",onClick:()=>n(!1),children:"Cancel"})]})]})})]}),e.jsx(o,{className:"bg-blue-50 dark:bg-blue-950 border-blue-200",children:e.jsxs(c,{className:"pt-6",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Secure Payment Processing"}),e.jsxs("ul",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsx("li",{children:"• All payments are processed securely through Stripe"}),e.jsx("li",{children:"• Your card details are encrypted and never stored on our servers"}),e.jsx("li",{children:"• PCI DSS compliant payment processing"}),e.jsx("li",{children:"• 3D Secure authentication for added security"}),e.jsx("li",{children:"• Instant refunds processed to your original payment method"})]})]})})]})}export{q as PaymentMethods};
