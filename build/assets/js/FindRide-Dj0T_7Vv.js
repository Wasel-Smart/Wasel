import{r as c,j as e,m as U,n as V,o as W,p as K,q as Q,s as X,t as G}from"./vendor-ui-S1-b02vM.js";import{c as M,a as b,B as x,M as J,h as _,p as w,u as Y,C as k,b as Z,d as ee,e as se,f as C,w as ae,t as g}from"./index-C4myuZdd.js";import{I as y}from"./input-B6A87FZ6.js";import{L as l}from"./label-BRQac6GQ.js";import{S as f}from"./switch-d-2WclGi.js";import{D as te,a as re,b as le,c as ie}from"./dialog-y1zr9Dfl.js";import{M as ne,a as ce}from"./useTrips-BBJaC5In.js";import{A as de,a as oe}from"./avatar-BeTgQo5q.js";import{S as z}from"./sparkles-CNaXPMKw.js";import{S as me}from"./smartphone-BQgG8q0v.js";import{L as S}from"./locate-vTgYpdHc.js";import{C as B}from"./calendar-clock-DRJnYAdV.js";import{T as xe}from"./timer-C9OLMlzC.js";import{U as O}from"./users-round-6idvwZaa.js";import{C as he}from"./circle-dollar-sign-CSf7pR0F.js";import{u as pe}from"./useBookings-DDDAlem2.js";import{M as je}from"./move-right-xBcSULm3.js";import"./vendor-react-7PqXWhc5.js";import"./vendor-utils-Drrw94dm.js";import"./vendor-supabase-DCWnlmhc.js";import"./vendor-animation-BozBRtxF.js";import"./serviceFactory-BhemUNoC.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],fe=M("sliders-horizontal",ge);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}]],ve=M("sparkle",ue);function F({className:a,defaultValue:d,value:h,min:o=0,max:r=100,...p}){const u=c.useMemo(()=>Array.isArray(h)?h:Array.isArray(d)?d:[o,r],[h,d,o,r]);return e.jsxs(U,{"data-slot":"slider",defaultValue:d,value:h,min:o,max:r,className:b("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",a),...p,children:[e.jsx(V,{"data-slot":"slider-track",className:b("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-4 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:e.jsx(W,{"data-slot":"slider-range",className:b("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:u.length},(i,n)=>e.jsx(K,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},n))]})}function ye({...a}){return e.jsx(Q,{"data-slot":"collapsible",...a})}function Ne({...a}){return e.jsx(X,{"data-slot":"collapsible-trigger",...a})}function be({...a}){return e.jsx(G,{"data-slot":"collapsible-content",...a})}function we({trip:a,open:d,onClose:h,onBook:o}){const[r,p]=c.useState(1);if(!a)return null;const u=[{lat:a.stops?.[0]?.lat||25.2048,lng:a.stops?.[0]?.lng||55.2708,label:a.from,type:"start"},...a.stops?.slice(1,-1).map((i,n)=>({lat:i.lat,lng:i.lng,label:i.label,type:"stop"}))||[],{lat:a.stops?.[a.stops.length-1]?.lat||24.4539,lng:a.stops?.[a.stops.length-1]?.lng||54.3773,label:a.to,type:"destination"}];return e.jsx(te,{open:d,onOpenChange:h,children:e.jsxs(re,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(le,{children:e.jsx(ie,{children:"Trip Details"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(de,{className:"w-16 h-16",children:e.jsx(oe,{className:"bg-primary text-primary-foreground text-xl",children:a.driver.initials})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{children:a.driver.name}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground mt-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:a.driver.rating})]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[a.driver.trips," trips completed"]})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsxs(x,{size:"sm",variant:"outline",className:"gap-2",children:[e.jsx(me,{className:"w-4 h-4"}),"Call"]}),e.jsxs(x,{size:"sm",variant:"outline",className:"gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),"Message"]})]})]}),e.jsx(_,{variant:a.tripType==="wasel"?"default":"secondary",children:a.tripType==="wasel"?"Wasel (ÙˆØ§ØµÙ„)":"Raje3 (Ø±Ø§Ø¬Ø¹)"})]}),e.jsx(w,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{children:"Route & Stops"}),e.jsx(ne,{locations:u,showRoute:!0,height:"350px"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{children:"Trip Information"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(S,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Route"}),e.jsxs("p",{children:[a.from," â†’ ",a.to]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(B,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Date"}),e.jsx("p",{children:a.date})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(xe,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Departure Time"}),e.jsx("p",{children:a.time})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{children:"Booking Details"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(O,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Available Seats"}),e.jsxs("p",{children:[a.seats," seats left"]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(he,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Price per Seat"}),e.jsxs("p",{className:"text-2xl text-primary",children:["$",a.price]})]})]}),a.vehicleModel&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-5 h-5 flex items-center justify-center mt-0.5",children:"ðŸš—"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Vehicle"}),e.jsx("p",{children:a.vehicleModel})]})]})]})]}),a.stops&&a.stops.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(w,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{children:"Stops Along the Way"}),e.jsx("div",{className:"space-y-2",children:a.stops.map((i,n)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:`
                        w-6 h-6 rounded-full flex items-center justify-center text-xs
                        ${n===0?"bg-primary text-primary-foreground":n===a.stops.length-1?"bg-accent text-accent-foreground":"bg-secondary text-secondary-foreground"}
                      `,children:n===0?"A":n===a.stops.length-1?"B":n}),e.jsx("p",{children:i.label})]},n))})]})]}),a.notes&&e.jsxs(e.Fragment,{children:[e.jsx(w,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{children:"Additional Notes"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.notes})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Number of Seats"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(x,{size:"sm",variant:"outline",onClick:()=>p(Math.max(1,r-1)),disabled:r<=1,children:"-"}),e.jsx("span",{className:"w-8 text-center",children:r}),e.jsx(x,{size:"sm",variant:"outline",onClick:()=>p(Math.min(a.seats,r+1)),disabled:r>=a.seats,children:"+"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Price"}),e.jsxs("p",{className:"text-2xl text-primary",children:["$",a.price*r]})]})]}),e.jsxs(x,{size:"lg",className:"bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>{o&&o(a.id),h()},children:["Book ",r," Seat",r>1?"s":""]})]})]})]})})}function Qe(){const{user:a}=Y(),[d,h]=c.useState(""),[o,r]=c.useState(""),[p,u]=c.useState(""),[i,n]=c.useState("1"),[P,q]=c.useState(null),[I,N]=c.useState(!1),[R,D]=c.useState(!1),[ke,Ce]=c.useState("match"),{trips:T,loading:v,searchTrips:A}=ce({from:d,to:o,departureDate:p,seats:parseInt(i)}),[m,j]=c.useState({priceRange:[0,200],minRating:4,verifiedOnly:!1,instantBook:!1,preferences:{noSmoking:!1,petsAllowed:!1,musicOk:!1,quietRide:!1}}),L=()=>{if(!d.trim()){g.error("Please enter a starting location");return}if(!o.trim()){g.error("Please enter a destination");return}if(!p){g.error("Please select a date");return}if(parseInt(i)<1||parseInt(i)>8){g.error("Number of passengers must be between 1 and 8");return}const s=new Date(p),t=new Date;if(t.setHours(0,0,0,0),s<t){g.error("Please select a future date");return}A()},$=s=>{const t={id:parseInt(s.id.replace("trip-",""))||1,driver:{name:"Driver Name",initials:"DN",rating:4.5,trips:25},from:s.from,to:s.to,date:s.departure_date,time:s.departure_time,seats:s.available_seats,price:s.price_per_seat,tripType:"wasel"};q(t),N(!0)},{createBooking:H}=pe(),E=async s=>{if(!a){g.error("Please sign in to book a trip");return}try{const{error:t}=await H({trip_id:s.toString(),seats_requested:parseInt(i)});if(t){g.error(t);return}g.success('Trip booked successfully! Check "My Trips" for details.'),N(!1),A()}catch(t){g.error(t.message||"Failed to book trip")}};return e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsxs(k,{children:[e.jsxs(Z,{children:[e.jsx(ee,{children:"Find a Ride"}),e.jsx(se,{children:"Search for available rides across the Middle East"})]}),e.jsxs(C,{children:[e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"From"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground"}),e.jsx(y,{placeholder:"Starting location",value:d,onChange:s=>h(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"To"}),e.jsxs("div",{className:"relative",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground"}),e.jsx(y,{placeholder:"Destination",value:o,onChange:s=>r(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground"}),e.jsx(y,{type:"date",value:p,onChange:s=>u(s.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Passengers"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground"}),e.jsx(y,{type:"number",min:"1",max:"8",value:i,onChange:s=>n(s.target.value),className:"pl-10"})]})]})]}),e.jsx(x,{className:"w-full md:w-auto mt-4 bg-primary hover:bg-primary/90 text-primary-foreground",onClick:L,disabled:v,children:v?"Searching...":"Search Rides"})]})]}),e.jsx(k,{children:e.jsx(C,{className:"pt-6",children:e.jsxs(ye,{open:R,onOpenChange:D,children:[e.jsx(Ne,{asChild:!0,children:e.jsxs(x,{variant:"outline",className:"w-full justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-4 h-4"}),"Advanced Filters"]}),R?e.jsx(ae,{className:"w-4 h-4"}):e.jsx(ve,{className:"w-4 h-4"})]})}),e.jsxs(be,{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{children:["Max Price: $",m.priceRange[1]]}),e.jsx(F,{value:m.priceRange,onValueChange:s=>j(t=>({...t,priceRange:s})),max:500,min:0,step:10,className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{children:["Minimum Rating: ",m.minRating," stars"]}),e.jsx(F,{value:[m.minRating],onValueChange:s=>j(t=>({...t,minRating:s[0]})),max:5,min:0,step:.5,className:"w-full"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{children:"Preferences"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{id:"no-smoking",checked:m.preferences.noSmoking,onCheckedChange:s=>j(t=>({...t,preferences:{...t.preferences,noSmoking:s}}))}),e.jsx(l,{htmlFor:"no-smoking",children:"No Smoking"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{id:"pets-allowed",checked:m.preferences.petsAllowed,onCheckedChange:s=>j(t=>({...t,preferences:{...t.preferences,petsAllowed:s}}))}),e.jsx(l,{htmlFor:"pets-allowed",children:"Pets Allowed"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{id:"music-ok",checked:m.preferences.musicOk,onCheckedChange:s=>j(t=>({...t,preferences:{...t.preferences,musicOk:s}}))}),e.jsx(l,{htmlFor:"music-ok",children:"Music OK"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{id:"quiet-ride",checked:m.preferences.quietRide,onCheckedChange:s=>j(t=>({...t,preferences:{...t.preferences,quietRide:s}}))}),e.jsx(l,{htmlFor:"quiet-ride",children:"Quiet Ride"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{id:"verified-only",checked:m.verifiedOnly,onCheckedChange:s=>j(t=>({...t,verifiedOnly:s}))}),e.jsx(l,{htmlFor:"verified-only",children:"Verified Drivers Only"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{id:"instant-book",checked:m.instantBook,onCheckedChange:s=>j(t=>({...t,instantBook:s}))}),e.jsx(l,{htmlFor:"instant-book",children:"Instant Book"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(x,{variant:"outline",onClick:()=>j({priceRange:[0,200],minRating:4,verifiedOnly:!1,instantBook:!1,preferences:{noSmoking:!1,petsAllowed:!1,musicOk:!1,quietRide:!1}}),children:"Reset Filters"}),e.jsx(x,{onClick:()=>D(!1),children:"Apply Filters"})]})]})]})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{children:"Available Rides"}),v&&e.jsx("p",{children:"Loading rides..."}),!v&&T.length===0&&e.jsx("p",{children:"No rides found. Try changing your search criteria."}),e.jsx("div",{className:"space-y-4",children:T.map(s=>e.jsx(k,{className:"hover:shadow-md transition-shadow",children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{children:s.driver?.initials||"DR"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.driver?.name||"Unknown Driver"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(z,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:s.driver?.rating||"New"}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[s.driver?.trips||0," trips"]})]})]})]}),e.jsx("div",{className:"flex-1 flex items-center gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"font-medium",children:s.from}),e.jsx(je,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"font-medium",children:s.to})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600",children:[e.jsx("span",{children:s.departure_date}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:s.departure_time}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[s.available_seats," seats left"]})]})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl text-primary",children:["$",s.price_per_seat]}),e.jsx("p",{className:"text-sm text-gray-500",children:"per seat"})]}),s.type&&e.jsx(_,{variant:s.type==="wasel"?"default":"secondary",children:s.type==="wasel"?"Wasel (ÙˆØ§ØµÙ„)":"Raje3 (Ø±Ø§Ø¬Ø¹)"}),e.jsx(x,{className:"bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>$(s),children:"View Details"})]})]})})},s.id))})]}),e.jsx(we,{trip:P,open:I,onClose:()=>N(!1),onBook:E})]})}export{Qe as FindRide};
