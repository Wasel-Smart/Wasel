import{r as l,j as e}from"./vendor-ui-jVyU-rC5.js";import{B as c,M as L,f as S,p as u,u as I,C as w,a as O,b as P,d as _,e as b,t as f}from"./index-BMnkv4Hv.js";import{I as h}from"./input-BadvQ2Zs.js";import{L as p}from"./label-kKliBi_n.js";import{D as $,a as E,b as U,c as V}from"./dialog-CPCIRgso.js";import{M as W}from"./MapComponent-W-VMxfMP.js";import{A as q,a as H}from"./avatar-DaMEyjke.js";import{S as C}from"./sparkles-CA785dog.js";import{S as G}from"./smartphone-D1q7Y5Wg.js";import{L as v}from"./locate-g6lwp3e4.js";import{C as D}from"./calendar-clock-Bj3_sxWI.js";import{T as J}from"./timer-aaSEBnAX.js";import{U as T}from"./users-round-syyZsHNZ.js";import{C as K}from"./circle-dollar-sign-CzoWWzbD.js";import{a as Q}from"./useTrips-MX0JAxjI.js";import{d as X}from"./mockDataService-9NqzqVZZ.js";import{M as Y}from"./move-right-CZ_smPy8.js";import"./vendor-react-7PqXWhc5.js";import"./vendor-utils-CADQ8aCF.js";import"./vendor-supabase-b92lme3K.js";import"./vendor-animation-BozBRtxF.js";function Z({trip:s,open:m,onClose:o,onBook:n}){const[t,d]=l.useState(1);if(!s)return null;const j=[{lat:s.stops?.[0]?.lat||25.2048,lng:s.stops?.[0]?.lng||55.2708,label:s.from,type:"start"},...s.stops?.slice(1,-1).map((r,i)=>({lat:r.lat,lng:r.lng,label:r.label,type:"stop"}))||[],{lat:s.stops?.[s.stops.length-1]?.lat||24.4539,lng:s.stops?.[s.stops.length-1]?.lng||54.3773,label:s.to,type:"destination"}];return e.jsx($,{open:m,onOpenChange:o,children:e.jsxs(E,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(U,{children:e.jsx(V,{children:"Trip Details"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(q,{className:"w-16 h-16",children:e.jsx(H,{className:"bg-primary text-primary-foreground text-xl",children:s.driver.initials})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{children:s.driver.name}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-muted-foreground mt-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(C,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:s.driver.rating})]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[s.driver.trips," trips completed"]})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsxs(c,{size:"sm",variant:"outline",className:"gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),"Call"]}),e.jsxs(c,{size:"sm",variant:"outline",className:"gap-2",children:[e.jsx(L,{className:"w-4 h-4"}),"Message"]})]})]}),e.jsx(S,{variant:s.tripType==="wasel"?"default":"secondary",children:s.tripType==="wasel"?"Wasel (ÙˆØ§ØµÙ„)":"Raje3 (Ø±Ø§Ø¬Ø¹)"})]}),e.jsx(u,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{children:"Route & Stops"}),e.jsx(W,{locations:j,showRoute:!0,height:"350px"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{children:"Trip Information"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(v,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Route"}),e.jsxs("p",{children:[s.from," â†’ ",s.to]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(D,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Date"}),e.jsx("p",{children:s.date})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(J,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Departure Time"}),e.jsx("p",{children:s.time})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{children:"Booking Details"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(T,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Available Seats"}),e.jsxs("p",{children:[s.seats," seats left"]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(K,{className:"w-5 h-5 text-primary mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Price per Seat"}),e.jsxs("p",{className:"text-2xl text-primary",children:["$",s.price]})]})]}),s.vehicleModel&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-5 h-5 flex items-center justify-center mt-0.5",children:"ðŸš—"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Vehicle"}),e.jsx("p",{children:s.vehicleModel})]})]})]})]}),s.stops&&s.stops.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(u,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{children:"Stops Along the Way"}),e.jsx("div",{className:"space-y-2",children:s.stops.map((r,i)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:`
                        w-6 h-6 rounded-full flex items-center justify-center text-xs
                        ${i===0?"bg-primary text-primary-foreground":i===s.stops.length-1?"bg-accent text-accent-foreground":"bg-secondary text-secondary-foreground"}
                      `,children:i===0?"A":i===s.stops.length-1?"B":i}),e.jsx("p",{children:r.label})]},i))})]})]}),s.notes&&e.jsxs(e.Fragment,{children:[e.jsx(u,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{children:"Additional Notes"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.notes})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Number of Seats"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(c,{size:"sm",variant:"outline",onClick:()=>d(Math.max(1,t-1)),disabled:t<=1,children:"-"}),e.jsx("span",{className:"w-8 text-center",children:t}),e.jsx(c,{size:"sm",variant:"outline",onClick:()=>d(Math.min(s.seats,t+1)),disabled:t>=s.seats,children:"+"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Price"}),e.jsxs("p",{className:"text-2xl text-primary",children:["$",s.price*t]})]})]}),e.jsxs(c,{size:"lg",className:"bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>{n&&n(s.id),o()},children:["Book ",t," Seat",t>1?"s":""]})]})]})]})})}function Te(){const{user:s}=I(),[m,o]=l.useState(""),[n,t]=l.useState(""),[d,j]=l.useState(""),[r,i]=l.useState("1"),[k,R]=l.useState(null),[M,g]=l.useState(!1),[ee,se]=l.useState(!1),[ae,te]=l.useState("match"),{trips:N,loading:x,searchTrips:y}=Q({from:m,to:n,departureDate:d,seats:parseInt(r)}),[le,re]=l.useState({priceRange:[0,200],minRating:4,verifiedOnly:!1,instantBook:!1,preferences:{noSmoking:!1,petsAllowed:!1,musicOk:!1,quietRide:!1}}),F=()=>{y()},B=a=>{R(a),g(!0)},A=async a=>{if(!s){f.error("Please sign in to book a trip");return}try{await X.createBooking(a,parseInt(r)),f.success('Trip booked successfully! Check "My Trips" for details.'),g(!1),y()}catch(z){f.error(z.message||"Failed to book trip")}};return e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsxs(w,{children:[e.jsxs(O,{children:[e.jsx(P,{children:"Find a Ride"}),e.jsx(_,{children:"Search for available rides across the Middle East"})]}),e.jsxs(b,{children:[e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"From"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground"}),e.jsx(h,{placeholder:"Starting location",value:m,onChange:a=>o(a.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"To"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground"}),e.jsx(h,{placeholder:"Destination",value:n,onChange:a=>t(a.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground"}),e.jsx(h,{type:"date",value:d,onChange:a=>j(a.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{children:"Passengers"}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 -translate-y-1/2 size-4 text-muted-foreground"}),e.jsx(h,{type:"number",min:"1",max:"8",value:r,onChange:a=>i(a.target.value),className:"pl-10"})]})]})]}),e.jsx(c,{className:"w-full md:w-auto mt-4 bg-primary hover:bg-primary/90 text-primary-foreground",onClick:F,disabled:x,children:x?"Searching...":"Search Rides"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{children:"Available Rides"}),x&&e.jsx("p",{children:"Loading rides..."}),!x&&N.length===0&&e.jsx("p",{children:"No rides found. Try changing your search criteria."}),e.jsx("div",{className:"space-y-4",children:N.map(a=>e.jsx(w,{className:"hover:shadow-md transition-shadow",children:e.jsx(b,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center",children:e.jsx("span",{children:a.driver?.initials||"DR"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.driver?.name||"Unknown Driver"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(C,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:a.driver?.rating||"New"}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[a.driver?.trips||0," trips"]})]})]})]}),e.jsx("div",{className:"flex-1 flex items-center gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"font-medium",children:a.from}),e.jsx(Y,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"font-medium",children:a.to})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600",children:[e.jsx("span",{children:a.departure_date}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:a.departure_time}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[a.available_seats," seats left"]})]})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl text-primary",children:["$",a.price_per_seat]}),e.jsx("p",{className:"text-sm text-gray-500",children:"per seat"})]}),a.type&&e.jsx(S,{variant:a.type==="wasel"?"default":"secondary",children:a.type==="wasel"?"Wasel (ÙˆØ§ØµÙ„)":"Raje3 (Ø±Ø§Ø¬Ø¹)"}),e.jsx(c,{className:"bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>B(a),children:"View Details"})]})]})})},a.id))})]}),e.jsx(Z,{trip:k,open:M,onClose:()=>g(!1),onBook:A})]})}export{Te as FindRide};
